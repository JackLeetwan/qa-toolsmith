---
// @ts-nocheck
/* global Astro */
import AuthLayout from "@/layouts/AuthLayout.astro";
import LoginForm from "@/components/auth/LoginForm";
import { Alert, AlertDescription } from "@/components/ui/alert";

// Redirect if already logged in
const user = Astro.locals.user;

if (user) {
  const url = new URL(Astro.request.url);
  const nextUrl = url.searchParams.get("next") || "/";
  return Astro.redirect(nextUrl);
}

const currentUrl = new URL(Astro.request.url);
const showCheckEmailBanner = currentUrl.searchParams.get("check_email") === "1";
---

<AuthLayout title="Logowanie" description="Zaloguj się do swojego konta">
  {showCheckEmailBanner && (
    <Alert>
      <AlertDescription>
        Konto utworzone! Sprawdź swoją skrzynkę email i potwierdź adres, aby się zalogować.
      </AlertDescription>
    </Alert>
  )}
  <LoginForm client:idle />
</AuthLayout>
